---
import { CollectionEntry, getCollection } from "astro:content";
import PostPreview from "./PostPreview.astro";

interface Props {
  filter?: (post: CollectionEntry<"posts">) => boolean;
  sort?: (a: CollectionEntry<"posts">, b: CollectionEntry<"posts">) => number;
  limit?: number;
  offset?: number;
}

const { filter, sort, offset, limit } = Astro.props;
const posts = await getCollection("posts");
let data = filter ? posts.filter(filter) : posts;
data = data.sort(
  sort ? sort : (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
data = data.slice(offset, limit);
---

<ul>
  {
    data.map((post) => (
      <li>
        <PostPreview data={post} />
      </li>
    ))
  }
</ul>

<style>
  ul {
    margin: 0;
    padding: 0;
  }

  li {
    list-style: none;
  }
</style>
